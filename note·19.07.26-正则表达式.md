## 正则表达式

- 正则表达式是字符串处理的有力工具，正则表达式使用预定义的模式去匹配一类具有共同特征的字符串，可以快速、准确地完成复杂的查找、替换等处理要求，比字符串自身提供的方法提供了更强大的处理功能。例如使用字符串对象的split()方法只能指定一个分隔符，而使用正则表达式可以很方便地指定多个符号作为分隔符；使用字符串对象的split()并指定分隔符时，很难处理分隔符连续多次出现的情况，而正则表达式让这一切都变成非常轻松。
- 正则表达式在文本编辑与处理、网页爬虫之类的场合中有重要应用。

### 正则表达式语法

正则表达式由元字符及其不同组合来构成，通过巧妙地构造正则表达式可以匹配任意字符串，并完成查找、替换、分隔等复杂的字符串处理任务。

### 正则表达式基本语法

- 如果以“\”开头的元字符与转义字符相同，则需要使用“\\”，或者使用原始字符串。
- 在字符串前加上字符r或R之后表示原始字符串，字符串中任意字符都不再进行转义。原始字符串可以减少用户的输入，主要用于正则表达式和文件路径字符串的情况，但如果字符串以一个斜线“\”结束的话，则需要多写一个斜线，即以“\\”结束。

| 元字符 |                           功能说明                           |
| :----: | :----------------------------------------------------------: |
|   .    |                匹配除换行符以外的任意单个字符                |
|   *    |          匹配位于*之前的字符或子模式的0次或多次出现          |
|   +    |          匹配位于+之前的字符或子模式的1次或多次出现          |
|   -    |                     在[]之内用来表示范围                     |
|   \|   |                  匹配位于\|之前或之后的字符                  |
|   ^    |           匹配行首，匹配以^后面的字符开头的字符串            |
|   $    |           匹配行尾，匹配以$之前的字符结束的字符串            |
|   ?    | 匹配位于?之前的0个或1个字符。当此字符紧随任何其他限定符（*、+、?、{n}、{n,}、{n,m}）之后时，匹配模式是“非贪心的”。“非贪心的”模式匹配搜索到的、尽可能短的字符串，而默认的“贪心的”模式匹配搜索到的、尽可能长的字符串。例如，在字符串“oooo”中，“o+?”只匹配单个“o”，而“o+”匹配所有“o” |
|   \    |                  表示位于\之后的为转义字符                   |
|  \num  | 此处的num是一个正整数，表示子模式编号。例如，“(.)\1”匹配两个连续的相同字符 |
|   \f   |                          换页符匹配                          |
|   \n   |                          换行符匹配                          |
|   \r   |                        匹配一个回车符                        |
|   \b   |                      匹配单词头或单词尾                      |
|   \B   |                         与\b含义相反                         |
|   \d   |                  匹配任何数字，相当于[0-9]                   |
|   \D   |                 与\d含义相反，等效于[ ^0-9 ]                 |
|   \s   | 匹配任何空白字符，包括空格、制表符、换页符，与 [ \f\n\r\t\v] 等效 |
|   \S   |                         与\s含义相反                         |
|   \w   |       匹配任何字母、数字以及下划线，相当于[a-zA-Z0-9_]       |
|   \W   |       与\w含义相反\w含义相反，与“[ ^A-Za-z0-9_ ]”等效        |
|   ()   |              将位于()内的内容作为一个整体来对待              |
| {m,n}  |            {}前的字符或子模式重复至少m次，至多n次            |
|   []   |             表示范围，匹配位于[]中的任意一个字符             |
| [^xyz] |           反向字符集，匹配除x、y、z之外的任何字符            |
| [a-z]  |              字符范围，匹配指定范围内的任何字符              |
| [^a-z] |        反向范围字符，匹配除小写英文字母之外的任何字符        |

### 正则表达式扩展语法

- 正则表达式使用圆括号“()”表示一个子模式，圆括号内的内容作为一个整体对待，例如'(red)+'可以匹配'redred'、'redredred'等一个或多个重复'red'的情况。
- 使用子模式扩展语法可以实现更加复杂的字符串处理功能。

|       语法       |                           功能说明                           |
| :--------------: | :----------------------------------------------------------: |
| (?P<.groupname>) |                         为子模式命名                         |
|    (?iLmsux)     | 设置匹配标志，可以是几个字母的组合，每个字母含义与编译标志相同 |
|    (?: . . .)    |                 匹配但不捕获该匹配的子表达式                 |
|  (?P=groupname)  |            表示在此之前的命名为groupname的子模式             |
|    (?#. . .)     |                           表示注释                           |
|     (?<=···)     | 用于正则表达式之前，表示如果<=后的内容在字符串中不出现则匹配，但不返回<=之后的内容 |
|     (?=···)      | 用于正则表达式之后，表示如果=后的内容在字符串中出现则匹配，但不返回=之后的内容 |
|    (?<!. . .)    | 用于正则表达式之前，表示如果<!后的内容在字符串中不出现则匹配，但不返回<!之后的内容 |
|    (?!. . .)     | 用于正则表达式之后，表示如果!后的内容在字符串中不出现则匹配，但不返回!之后的内容 |

### 正则表达式

- 最简单的正则表达式是普通字符串，可以匹配自身

  - '[pjc]ython'可以匹配'python'、'jython'、'cython'

  - '[a-zA-Z0-9]'可以匹配一个任意大小写字母或数字
  - '[ ^abc ]'可以一个匹配任意除'a'、'b'、'c'之外的字符
  - 'python|perl'或'p(ython|erl)'都可以匹配'python'或'perl'

- 子模式后面加上问号表示可选。

  - r'(http://)?(www\.)?python\.org'只能匹配

  - 'http://www.python.org'、'http://python.org'、'www.python.org'和'python.org'

- '^http'只能匹配所有以'http'开头的字符串

- (pattern)*：允许模式重复0次或多次

- (pattern)+：允许模式重复1次或多次

- (pattern){m,n}：允许模式重复m~n次

### 正则表达式模块re处理字符串

Python标准库re模块提供了正则表达式操作所需要的功能

|                 方法                 |                           功能说明                           |
| :----------------------------------: | :----------------------------------------------------------: |
|      compile(pattern[, flags])       |                         创建模式对象                         |
|            escape(string)            |             将字符串中所有特殊正则表达式字符转义             |
|  findall(pattern, string[, flags])   |         返回包含字符串中所有与给定模式匹配的项的列表         |
|  finditer(pattern, string, flags=0)  |  返回包含所有匹配项的迭代对象，其中每个匹配项都是match对象   |
| fullmatch(pattern, string, flags=0)  |       尝试把模式作用于整个字符串，返回match对象或None        |
|   match(pattern, string[, flags])    |        从字符串的开始处匹配模式，返回match对象或None         |
|               purge()                |                      清空正则表达式缓存                      |
|   search(pattern, string[, flags])   |         在整个字符串中寻找模式，返回match对象或None          |
| split(pattern, string[, maxsplit=0]) |                   根据模式匹配项分隔字符串                   |
|  sub(pat, repl, string[, count=0])   | 将字符串中所有与pat匹配的项用repl替换，返回新字符串，repl可以是字符串或返回字符串的可调用对象，作用于每个匹配的match对象 |
|  subn(pat, repl, string[, count=0])  | 将字符串中所有pat的匹配项用repl替换，返回包含新字符串和替换次数的二元元组，repl可以是字符串或返回字符串的可调用对象，作用于每个匹配的match对象 |

### re.match函数

- re.match 尝试从字符串的起始位置匹配一个模式，如果不是起始位置匹配成功的话，match()就返回none。

  - 函数语法:

    ```
    re.match(pattern, string, flags=0)
    ```

|  参数   |                             描述                             |
| :-----: | :----------------------------------------------------------: |
| pattern |                       匹配的正则表达式                       |
| string  |                       要匹配的字符串。                       |
|  flags  | 标志位，用于控制正则表达式的匹配方式，如：是否区分大小写，多行匹配等等。 |

- 匹配成功re.match方法返回一个匹配的对象,否则返回None

- 可以使用group(num) 或 groups() 匹配对象函数来获取匹配表达式。

  | 匹配对象方法 |                             描述                             |
  | :----------: | :----------------------------------------------------------: |
  | group(num=0) | 匹配的整个表达式的字符串，group() 可以一次输入多个组号，在这种情况下它将返回一个包含那些组所对应值的元组。 |
  |   groups()   |   返回一个包含所有小组字符串的元组，从 1 到 所含的小组号。   |

### re.search方法

- re.search扫描整个字符串并返回第一个成功的匹配

  - 函数语法：

    ```
    re.search(pattern, string, flags=0)
    ```

- 匹配成功re.search方法返回一个匹配的对象,否则返回None

- 可以使用group(num) 或 groups() 匹配对象函数来获取匹配表达式。

  | 匹配对象方法 |                             描述                             |
  | :----------: | :----------------------------------------------------------: |
  | group(num=0) | 匹配的整个表达式的字符串，group() 可以一次输入多个组号，在这种情况下它将返回一个包含那些组所对应值的元组。 |
  |   groups()   |   返回一个包含所有小组字符串的元组，从 1 到 所含的小组号。   |

### re.match与re.search的区别

- re.match只匹配字符串的开始，如果字符串开始不符合正则表达式，则匹配失败，函数返回None；而re.search匹配整个字符串，直到找到一个匹配。

### re.sub

- Python 的re模块提供了re.sub用于替换字符串中的匹配项。

  - 函数语法：

    ```
    re.sub(pattern, repl, string, count=0)
    ```

|  参数   |                         描述                          |
| :-----: | :---------------------------------------------------: |
| pattern |                  正则中的模式字符串                   |
|  repl   |            替换的字符串，也可为一个函数。             |
| string  |              要被查找替换的原始字符串。               |
|  count  | 模式匹配后替换的最大次数，默认 0 表示替换所有的匹配。 |

### compile 函数

- compile 函数用于编译正则表达式，生成一个正则表达式（ Pattern ）对象，供 match() 和 search() 这两个函数使用。

  - 函数语法：

    ```
    re.compile(pattern[, flags])
    ```

    

